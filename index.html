<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Alexia Melusine — Hub Central (Single File)</title>

  <!-- Fontes -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@500;900&family=Rajdhani:wght@300;500;700&display=swap" rel="stylesheet">

  <!-- Ícones -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" referrerpolicy="no-referrer" />

  <!-- Supabase -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

  <style>
    :root{
      --fire-rose:#ff0040;
      --iron-light:#6b0f8f;
      --dark-bg:#080808;
      --glass-bg:rgba(20,20,20,.78);
      --glass-2:rgba(255,255,255,.06);
      --border:rgba(255,255,255,.10);
      --muted:rgba(255,255,255,.68);
      --muted-2:rgba(255,255,255,.44);
      --shadow: 0 18px 60px rgba(0,0,0,.55);
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html{scroll-behavior:smooth}

    body{
      min-height:100vh;
      font-family:"Rajdhani", system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      color:#f2f2f2;
      background: var(--dark-bg);
      background-image:
        radial-gradient(circle at 50% 18%, rgba(255,0,64,.18), transparent 54%),
        radial-gradient(circle at 72% 62%, rgba(107,15,143,.16), transparent 58%),
        linear-gradient(to bottom, rgba(0,0,0,.62), rgba(0,0,0,.90)),
        url('https://raw.githubusercontent.com/alexialuzdeferro/pombagira-revelada/refs/heads/main/Al%C3%AA%20(3).png');
      background-size: cover;
      background-position: center;
      background-attachment: fixed;
      line-height:1.55;
    }

    a{color:inherit;text-decoration:none}
    ::selection{background: rgba(255,0,64,.35)}

    .container{max-width:1200px;margin:0 auto;padding: 24px 16px 96px;}

    header{
      margin-top: 18px;
      padding: 26px 18px;
      border: 1px solid var(--border);
      border-radius: 18px;
      background: linear-gradient(to bottom, rgba(255,255,255,.06), rgba(255,255,255,.03));
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow);
    }

    .hero{
      display:grid;
      gap: 18px;
      grid-template-columns: 200px 1fr;
      align-items: center;
    }

    .avatarWrap{position:relative;width: 180px;height:180px;margin:0 auto;}
    .avatarGlow{position:absolute;inset:-10px;border-radius:999px;background: radial-gradient(circle at 30% 30%, rgba(255,0,64,.50), transparent 55%), radial-gradient(circle at 70% 70%, rgba(107,15,143,.38), transparent 58%);filter: blur(10px);}
    .avatar{
      position:relative;
      width: 180px;height:180px;border-radius:999px;
      border: 4px solid rgba(255,0,64,.75);
      object-fit: cover;
      box-shadow: 0 0 24px rgba(255,0,64,.25);
    }

    h1{
      font-family:"Cinzel", serif;
      font-weight:900;
      letter-spacing:.06em;
      text-transform:uppercase;
      font-size: clamp(2rem, 4vw, 3rem);
      line-height:1.1;
      background: linear-gradient(45deg, #ffffff, var(--fire-rose));
      -webkit-background-clip:text;
      background-clip:text;
      color: transparent;
      margin-bottom: 6px;
    }

    .tagline{color: rgba(255,0,64,.92);letter-spacing:.28em;font-weight:700;font-size:.95rem;}
    .desc{margin-top: 10px;max-width: 60ch;color: var(--muted);font-style: italic;}

    .controls{
      margin-top: 18px;
      display:grid;
      grid-template-columns: 1fr auto;
      gap: 10px;
      align-items: center;
    }

    .search{
      display:flex;align-items:center;gap:10px;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 10px 12px;
      background: rgba(0,0,0,.30);
    }
    .search i{color: rgba(255,255,255,.70)}
    .search input{
      width:100%;
      background: transparent;
      border:0;
      outline:none;
      color: #fff;
      font-size: 1rem;
    }
    .search input::placeholder{color: rgba(255,255,255,.42)}

    .toggles{display:flex;flex-wrap:wrap;gap:10px;justify-content:flex-end}

    .pill{
      display:inline-flex;align-items:center;gap:8px;
      padding: 10px 12px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: rgba(0,0,0,.26);
      color: rgba(255,255,255,.82);
      font-weight: 700;
      cursor:pointer;
      user-select:none;
      transition: .2s ease;
      font-size: .9rem;
    }
    .pill:hover{border-color: rgba(255,0,64,.35); transform: translateY(-1px)}
    .pill.active{border-color: rgba(255,0,64,.65); background: rgba(255,0,64,.12); color:#fff;}

    .metaRow{
      margin-top: 12px;
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      align-items:center;
      color: rgba(255,255,255,.70);
      font-size:.95rem;
    }

    .badge{
      display:inline-flex;align-items:center;gap:10px;
      padding: 9px 12px;
      border-radius: 12px;
      border:1px solid var(--border);
      background: rgba(0,0,0,.22);
    }

    main{margin-top: 22px;}

    .grid{
      display:grid;
      grid-template-columns: repeat( auto-fit, minmax(290px, 1fr) );
      gap: 14px;
    }

    .section{
      border: 1px solid var(--border);
      border-radius: 18px;
      background: var(--glass-bg);
      backdrop-filter: blur(12px);
      box-shadow: 0 10px 30px rgba(0,0,0,.35);
      overflow:hidden;
    }

    .sectionHeader{
      padding: 14px 16px;
      display:flex;
      justify-content: space-between;
      align-items: baseline;
      border-bottom: 1px solid rgba(255,255,255,.10);
    }

    .sectionHeader h2{
      font-family:"Cinzel", serif;
      font-size: 1.2rem;
      letter-spacing: .03em;
    }
    .count{font-size:.85rem;color: rgba(255,255,255,.55)}

    .links{padding: 14px; display:flex; flex-direction:column; gap: 10px;}

    .link{
      display:flex; justify-content: space-between; align-items:center;
      gap: 12px;
      padding: 12px 12px;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,.08);
      background: var(--glass-2);
      transition: .2s ease;
    }

    .link:hover{transform: translateX(4px); background: rgba(255,0,64,.16); border-color: rgba(255,0,64,.30)}

    .left{min-width:0}
    .titleRow{display:flex; gap:8px; align-items:center;}

    .tTitle{font-weight:800;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
    .tUrl{margin-top:2px; font-size: .82rem; color: var(--muted-2); white-space:nowrap; overflow:hidden; text-overflow:ellipsis;}

    .tag{
      font-size: .72rem;
      font-weight: 900;
      letter-spacing: .12em;
      text-transform: uppercase;
      padding: 5px 8px;
      border-radius: 999px;
      border: 1px solid rgba(255,0,64,.35);
      background: rgba(255,0,64,.14);
      color: #ffd2dd;
      flex: 0 0 auto;
    }

    mark{
      background: rgba(255,0,64,.28);
      color: #fff;
      border-radius: 6px;
      padding: 0 4px;
    }

    .empty{
      margin-top: 18px;
      padding: 18px;
      border:1px solid var(--border);
      border-radius: 18px;
      background: rgba(255,255,255,.05);
      backdrop-filter: blur(10px);
      text-align:center;
      color: rgba(255,255,255,.80);
    }

    footer{
      margin-top: 26px;
      padding: 20px 10px;
      text-align:center;
      color: rgba(255,255,255,.55);
      font-size: .95rem;
    }

    .social{
      margin: 12px 0 6px;
      display:flex;
      justify-content:center;
      gap: 16px;
    }

    .social a{
      display:inline-flex; align-items:center; justify-content:center;
      width: 44px; height: 44px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.25);
      transition: .2s ease;
    }

    .social a:hover{transform: translateY(-2px); border-color: rgba(255,0,64,.35); color: #fff;}

    .counter{
      position: fixed;
      right: 14px;
      bottom: 14px;
      display:flex;
      align-items:center;
      gap: 8px;
      padding: 8px 10px;
      border-radius: 14px;
      border: 1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.32);
      backdrop-filter: blur(10px);
      box-shadow: 0 10px 28px rgba(0,0,0,.35);
      font-size: 12px;
      color: rgba(255,255,255,.75);
      cursor:pointer;
      transition: .2s ease;
      user-select:none;
    }

    .counter:hover{border-color: rgba(255,0,64,.25); background: rgba(0,0,0,.45)}
    .counter .num{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-weight: 800; color:#fff;}
    .counter.loading .num{opacity:.45; animation: blink 1s infinite;}

    @keyframes blink{0%,100%{opacity:1}50%{opacity:.3}}

    @media (max-width: 860px){
      .hero{grid-template-columns: 1fr; text-align:center;}
      .controls{grid-template-columns: 1fr;}
      .toggles{justify-content:center}
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <div class="hero">
        <div class="avatarWrap">
          <div class="avatarGlow" aria-hidden="true"></div>
          <img class="avatar" alt="Alexia Melusine" src="https://raw.githubusercontent.com/alexialuzdeferro/pombagira-revelada/refs/heads/main/Al%C3%AA%20(4).png" />
        </div>
        <div>
          <div class="tagline">LUZ DE FERRO • ROSA DE FOGO</div>
          <h1>Alexia Melusine</h1>
          <p class="desc">Hub Central Absoluto: portais, projetos, meditação, giras, oráculos e música — todos reunidos em um único lugar (42 links).</p>

          <div class="controls">
            <div class="search">
              <i class="fa-solid fa-magnifying-glass" aria-hidden="true"></i>
              <input id="q" type="text" placeholder="Buscar por nome, categoria ou URL..." autocomplete="off" />
            </div>
            <div class="toggles">
              <button class="pill" id="featuredBtn" type="button" title="Mostrar apenas destaques">
                <i class="fa-solid fa-star"></i> Destaques
              </button>
              <button class="pill" id="resetBtn" type="button" title="Limpar busca e filtros">
                <i class="fa-solid fa-eraser"></i> Limpar
              </button>
            </div>
          </div>

          <div class="metaRow">
            <div class="badge" id="metaCount">
              <i class="fa-solid fa-filter"></i>
              <span>Mostrando <b id="visibleCount">0</b> de <b id="totalCount">0</b></span>
            </div>
            <div class="badge" id="activeCategoryBadge">
              <i class="fa-solid fa-layer-group"></i>
              <span>Categoria: <b id="activeCategory">Todos</b></span>
            </div>
          </div>

          <div class="metaRow" id="categoryPills"></div>
        </div>
      </div>
    </header>

    <main>
      <div id="sections" class="grid"></div>
      <div id="empty" class="empty" style="display:none">
        <p><b>Nenhum portal encontrado</b> com os filtros atuais.</p>
        <p style="margin-top:6px;color:rgba(255,255,255,.55)">Dica: tente limpar a busca ou selecionar “Todos”.</p>
      </div>
    </main>

    <footer>
      <div class="social">
        <a href="https://www.instagram.com/almasdepombagira/" target="_blank" rel="noopener noreferrer" title="Instagram"><i class="fa-brands fa-instagram"></i></a>
        <a href="https://www.youtube.com/@almasdepombagira" target="_blank" rel="noopener noreferrer" title="YouTube"><i class="fa-brands fa-youtube"></i></a>
        <a href="https://www.tiktok.com/@almasdepombagira?lang=pt-BR" target="_blank" rel="noopener noreferrer" title="TikTok"><i class="fa-brands fa-tiktok"></i></a>
      </div>
      <div>© 2026 Alexia Melusine. Todos os direitos reservados.</div>
      <div style="margin-top:6px; font-size:.85rem; opacity:.75">Total de Portais Ativos: <b>42</b> | Single File</div>
    </footer>
  </div>

  <!-- Contador de visualizações -->
  <div class="counter" id="viewCounter" title="Clique para atualizar">
    <i class="fa-solid fa-eye" style="color:rgba(255,0,64,.85)"></i>
    <span class="num" id="counterNumber">0</span>
    <span class="label" style="display:none">Visualizações</span>
  </div>

  <script>
    // ===========================
    // DADOS (42 LINKS)
    // ===========================
    const DATA = {
      cover: "https://raw.githubusercontent.com/alexialuzdeferro/pombagira-revelada/refs/heads/main/Al%C3%AA%20(3).png",
      avatar: "https://raw.githubusercontent.com/alexialuzdeferro/pombagira-revelada/refs/heads/main/Al%C3%AA%20(4).png",
      categories: [
        "Identidade & Hubs",
        "Reino Pombagira",
        "Oráculos & Magia",
        "Giras & Sons",
        "Meditação",
        "Cartão de Visita",
        "Dark Waves & Music",
        "Galeria",
      ],
      links: [
        // Identidade & Hubs (11)
        { id: "bio-site", title: "Bio Site Oficial", url: "https://bio.site/AlmasdePombagira", category: "Identidade & Hubs", featured: true },
        { id: "linktree", title: "Linktree — Rosa de Fogo", url: "https://linktr.ee/alexiarosadefogo", category: "Identidade & Hubs", featured: true },
        { id: "canva-portal", title: "Portal Canva", url: "https://pombagiras.my.canva.site/", category: "Identidade & Hubs", featured: true },
        { id: "alexia-melusine-page", title: "Página Alexia Melusine", url: "https://alexialuzdeferro.github.io/alexia-melusine/", category: "Identidade & Hubs" },
        { id: "melusine", title: "Melusine", url: "https://alexialuzdeferro.github.io/melusine/", category: "Identidade & Hubs" },
        { id: "super-hub-central", title: "Super Hub Central", url: "https://alexialuzdeferro.github.io/super-hub-central/", category: "Identidade & Hubs" },
        { id: "hub-central-pombagiras", title: "Hub Central Pombagiras", url: "https://alexialuzdeferro.github.io/Hub-Central-Pombagiras/", category: "Identidade & Hubs" },
        { id: "hub-pombagiras", title: "Hub Pombagiras", url: "https://alexialuzdeferro.github.io/Hub-Pombagiras/", category: "Identidade & Hubs", featured: true },
        { id: "social-hub", title: "Social Hub", url: "https://alexialuzdeferro.github.io/social-hub/", category: "Identidade & Hubs" },
        { id: "redes-sociais", title: "Redes Sociais", url: "https://alexialuzdeferro.github.io/redes_sociais/", category: "Identidade & Hubs" },
        { id: "melusine-redes", title: "Melusine — Redes", url: "https://alexialuzdeferro.github.io/melusine_redes/", category: "Identidade & Hubs" },

        // Reino Pombagira (10)
        { id: "pombagira", title: "Pombagira", url: "https://alexialuzdeferro.github.io/pombagira/", category: "Reino Pombagira" },
        { id: "pombagira-revelada", title: "Pombagira Revelada", url: "https://alexialuzdeferro.github.io/pombagira-revelada/", category: "Reino Pombagira", featured: true },
        { id: "pombagira-revelada-underscore", title: "Pombagira Revelada (variação)", url: "https://alexialuzdeferro.github.io/pombagira_revelada/", category: "Reino Pombagira", note: "Mantido conforme URL fornecida" },
        { id: "pombagiras", title: "Pombagiras", url: "https://alexialuzdeferro.github.io/Pombagiras/", category: "Reino Pombagira" },
        { id: "almasdepombagira", title: "Almas de Pombagira", url: "https://alexialuzdeferro.github.io/almasdepombagira/", category: "Reino Pombagira", featured: true },
        { id: "minha-pombagira", title: "Minha Pombagira", url: "https://alexialuzdeferro.github.io/minha-pombagira/", category: "Reino Pombagira" },
        { id: "12rainhas", title: "12 Rainhas — Pombagiras", url: "https://alexialuzdeferro.github.io/12rainhas-pombagiras/", category: "Reino Pombagira" },
        { id: "giras", title: "Giras", url: "https://alexialuzdeferro.github.io/giras/", category: "Reino Pombagira" },
        { id: "misterio-das-giras", title: "Mistério das Giras", url: "https://alexialuzdeferro.github.io/misterio-das-giras/", category: "Reino Pombagira" },
        { id: "grimorio-github", title: "Grimório das Pombagiras (GitHub)", url: "https://github.com/alexialuzdeferro/grimorio-das-pombagiras/", category: "Reino Pombagira" },

        // Oráculos & Magia (4)
        { id: "oraculo-pombagiras", title: "Oráculo Pombagiras", url: "https://alexialuzdeferro.github.io/oraculo-pombagiras/", category: "Oráculos & Magia", featured: true },
        { id: "12-oraculo", title: "12 — Oráculo", url: "https://alexialuzdeferro.github.io/12-oraculo/", category: "Oráculos & Magia" },
        { id: "cartas-rosa-e-fogo", title: "Cartas Rosa e Fogo", url: "https://alexialuzdeferro.github.io/Cartas-Rosa-e-Fogo/", category: "Oráculos & Magia" },
        { id: "velas-virtuais", title: "Velas Virtuais", url: "https://alexialuzdeferro.github.io/Velas-Virtuais/", category: "Oráculos & Magia" },

        // Giras & Sons (3)
        { id: "pontos-cantados", title: "Pontos Cantados", url: "https://alexialuzdeferro.github.io/PONTOS-CANTADOS/", category: "Giras & Sons", featured: true },
        { id: "soundboard", title: "Soundboard — Pombagiras", url: "https://alexialuzdeferro.github.io/-Soundboard-Pombagiras-/", category: "Giras & Sons" },
        { id: "gira-completa", title: "Gira Completa", url: "https://alexialuzdeferro.github.io/gira-completa/", category: "Giras & Sons" },

        // Meditação (4)
        { id: "paz", title: "Espaço de Paz", url: "https://alexialuzdeferro.github.io/paz/", category: "Meditação" },
        { id: "relaxamento", title: "Relaxamento", url: "https://alexialuzdeferro.github.io/relaxamento/", category: "Meditação" },
        { id: "paz-interior", title: "Paz Interior", url: "https://alexialuzdeferro.github.io/paz_interior/", category: "Meditação" },
        { id: "meditacao", title: "Meditação", url: "https://alexialuzdeferro.github.io/medita-o/", category: "Meditação" },

        // Cartão de Visita (4)
        { id: "business-card", title: "Business Card", url: "https://alexialuzdeferro.github.io/Business-Card/", category: "Cartão de Visita" },
        { id: "card-visit", title: "Card Visit", url: "https://alexialuzdeferro.github.io/card_visit/", category: "Cartão de Visita" },
        { id: "melusine-card", title: "Melusine Card", url: "https://alexialuzdeferro.github.io/melusine-card/", category: "Cartão de Visita" },
        { id: "visitas-card", title: "Visitas — Card", url: "https://alexialuzdeferro.github.io/visitas-card/", category: "Cartão de Visita" },

        // Dark Waves & Music (5)
        { id: "dark-music", title: "Dark Music", url: "https://alexialuzdeferro.github.io/dark-music/", category: "Dark Waves & Music", featured: true },
        { id: "dark-tv", title: "Dark TV", url: "https://alexialuzdeferro.github.io/dark-tv/", category: "Dark Waves & Music" },
        { id: "dark-melancholy", title: "Dark Melancholy", url: "https://alexialuzdeferro.github.io/dark-melancholy/", category: "Dark Waves & Music" },
        { id: "tv-cyber-goth", title: "TV Cyber Goth", url: "https://alexialuzdeferro.github.io/tv-cyber-goth/", category: "Dark Waves & Music" },
        { id: "vampire-waves", title: "Vampire Waves", url: "https://alexialuzdeferro.github.io/vampire-waves/", category: "Dark Waves & Music" },

        // Galeria (1)
        { id: "card-photos", title: "Card Photos", url: "https://alexialuzdeferro.github.io/card-photos/", category: "Galeria" },
      ]
    };

    // ===========================
    // UI: estado e render
    // ===========================
    const state = {
      query: "",
      featuredOnly: false,
      category: "Todos",
    };

    const elQ = document.getElementById('q');
    const elFeatured = document.getElementById('featuredBtn');
    const elReset = document.getElementById('resetBtn');
    const elPills = document.getElementById('categoryPills');
    const elSections = document.getElementById('sections');
    const elEmpty = document.getElementById('empty');
    const elVisible = document.getElementById('visibleCount');
    const elTotal = document.getElementById('totalCount');
    const elActiveCategory = document.getElementById('activeCategory');

    elTotal.textContent = DATA.links.length.toLocaleString('pt-BR');

    function norm(s){ return (s||"").toString().trim().toLowerCase(); }

    function escapeHTML(s){
      return (s||"").toString()
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;')
        .replaceAll("'",'&#039;');
    }

    function highlight(text, q){
      const T = (text||"").toString();
      const Q = norm(q);
      if(!Q) return escapeHTML(T);
      const L = T.toLowerCase();
      const idx = L.indexOf(Q);
      if(idx === -1) return escapeHTML(T);
      const a = escapeHTML(T.slice(0, idx));
      const b = escapeHTML(T.slice(idx, idx + Q.length));
      const c = escapeHTML(T.slice(idx + Q.length));
      return `${a}<mark>${b}</mark>${c}`;
    }

    function makePill(label){
      const btn = document.createElement('button');
      btn.type = 'button';
      btn.className = 'pill';
      btn.textContent = label;
      btn.addEventListener('click', ()=>{
        state.category = label;
        render();
      });
      return btn;
    }

    function renderPills(){
      elPills.innerHTML = '';
      const all = makePill('Todos');
      elPills.appendChild(all);
      DATA.categories.forEach(c => elPills.appendChild(makePill(c)));
    }

    function filterLinks(){
      const q = norm(state.query);
      return DATA.links.filter(l => {
        if(state.featuredOnly && !l.featured) return false;
        if(state.category !== 'Todos' && l.category !== state.category) return false;
        if(!q) return true;
        const hay = `${l.title} ${l.url} ${l.category} ${l.note||''}`.toLowerCase();
        return hay.includes(q);
      });
    }

    function groupByCategory(links){
      const map = new Map();
      DATA.categories.forEach(c => map.set(c, []));
      links.forEach(l => {
        if(!map.has(l.category)) map.set(l.category, []);
        map.get(l.category).push(l);
      });
      return map;
    }

    function render(){
      const q = state.query;
      const filtered = filterLinks();
      const grouped = groupByCategory(filtered);

      // update header state
      elVisible.textContent = filtered.length.toLocaleString('pt-BR');
      elActiveCategory.textContent = state.category;

      // toggle pill classes
      document.querySelectorAll('.pill').forEach(p => {
        const label = p.textContent;
        if(label === state.category || (label === 'Todos' && state.category==='Todos')) p.classList.add('active');
        else p.classList.remove('active');
      });

      // featured state button
      elFeatured.classList.toggle('active', state.featuredOnly);

      // render sections
      elSections.innerHTML = '';
      let any = false;

      DATA.categories.forEach(category => {
        const links = grouped.get(category) || [];
        if(links.length === 0) return;
        any = true;

        const section = document.createElement('section');
        section.className = 'section';

        const header = document.createElement('div');
        header.className = 'sectionHeader';
        header.innerHTML = `<h2>${escapeHTML(category)}</h2><div class="count">${links.length} links</div>`;

        const list = document.createElement('div');
        list.className = 'links';

        links.forEach(l => {
          const a = document.createElement('a');
          a.className = 'link';
          a.href = l.url;
          a.target = '_blank';
          a.rel = 'noopener noreferrer';

          const tag = l.featured ? `<span class="tag"><i class="fa-solid fa-star"></i> Destaque</span>` : '';
          const note = l.note ? `<div class="tUrl">${highlight(l.note, q)}</div>` : '';

          a.innerHTML = `
            <div class="left">
              <div class="titleRow">
                <div class="tTitle">${highlight(l.title, q)}</div>
                ${tag}
              </div>
              <div class="tUrl">${highlight(l.url, q)}</div>
              ${note}
            </div>
            <div class="right" style="opacity:.85">
              <i class="fa-solid fa-arrow-up-right-from-square"></i>
            </div>
          `;

          list.appendChild(a);
        });

        section.appendChild(header);
        section.appendChild(list);
        elSections.appendChild(section);
      });

      elEmpty.style.display = any ? 'none' : 'block';
    }

    // events
    elQ.addEventListener('input', (e)=>{
      state.query = e.target.value || '';
      render();
    });

    elFeatured.addEventListener('click', ()=>{
      state.featuredOnly = !state.featuredOnly;
      render();
    });

    elReset.addEventListener('click', ()=>{
      state.query = '';
      state.featuredOnly = false;
      state.category = 'Todos';
      elQ.value = '';
      render();
    });

    // initial
    renderPills();
    render();
  </script>

  <script>
    // ===========================
    // CONTADOR DE VISUALIZAÇÕES (Supabase)
    // ID da página mantido: start
    // ===========================
    const CONFIG = {
      SUPABASE_URL: 'https://rbygxkbewzknvjjhxdvw.supabase.co',
      SUPABASE_KEY: 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InJieWd4a2Jld3prbnZqamh4ZHZ3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjYwMDcxNjQsImV4cCI6MjA4MTU4MzE2NH0.YrHF9HEGo6yv9MyNsPzFgBhaAB1DRh2SLU8f7L6s1nY',
      PAGE_NAME: 'start',
      SESSION_KEY: 'page_visit_start'
    };

    const viewCounter = document.getElementById('viewCounter');
    const counterNumber = document.getElementById('counterNumber');

    const { createClient } = supabase;
    const supabaseClient = createClient(CONFIG.SUPABASE_URL, CONFIG.SUPABASE_KEY);

    function hasVisitedInThisSession(){
      return sessionStorage.getItem(CONFIG.SESSION_KEY) === 'true';
    }
    function markAsVisited(){
      sessionStorage.setItem(CONFIG.SESSION_KEY, 'true');
    }

    async function loadCurrentCount(){
      viewCounter.classList.add('loading');
      try {
        const { data, error } = await supabaseClient
          .from('page_views')
          .select('view_count')
          .eq('page', CONFIG.PAGE_NAME)
          .single();

        let count = 0;
        if (error && error.code !== 'PGRST116') throw error;
        if (data) count = data.view_count || 0;
        counterNumber.textContent = count.toLocaleString('pt-BR');

      } catch (err) {
        counterNumber.textContent = '?';
      } finally {
        viewCounter.classList.remove('loading');
      }
    }

    function useLocalStorageFallback(){
      const key = `counter_${CONFIG.PAGE_NAME}`;
      let count = parseInt(localStorage.getItem(key)) || 0;
      count++;
      localStorage.setItem(key, count);
      counterNumber.textContent = count.toLocaleString('pt-BR');
      viewCounter.title = 'Modo offline (localStorage) — clique para atualizar';
    }

    async function incrementCount(){
      viewCounter.classList.add('loading');
      try {
        const { data, error } = await supabaseClient
          .rpc('increment_page_view', { target_page: CONFIG.PAGE_NAME });

        if (error) throw error;
        counterNumber.textContent = Number(data).toLocaleString('pt-BR');

      } catch (err) {
        useLocalStorageFallback();
      } finally {
        viewCounter.classList.remove('loading');
      }
    }

    async function initCounter(){
      await loadCurrentCount();
      if(!hasVisitedInThisSession()){
        await incrementCount();
        markAsVisited();
      }
      viewCounter.addEventListener('click', loadCurrentCount);
    }

    document.addEventListener('DOMContentLoaded', initCounter);
  </script>
</body>
</html>
